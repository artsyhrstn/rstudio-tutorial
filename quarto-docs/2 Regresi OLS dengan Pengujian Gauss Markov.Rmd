---
title: "R Notebook"
output: html_notebook
---

Aplikasi regresi pada RStudio

# 1. Buka File

```{r}
library(readxl)

# Inisialisasi data yang akan digunakan
data_kpr <- read_excel("C:\\Users\\hisbi\\OneDrive\\Documents\\GitHub\\rstudio-tutorial\\data-ipb\\Bab 2\\data1.xlsx")

# Mengganti nama variabel
names(data_kpr)[2] <- "OutstandingKPR"
names(data_kpr)[7] <- "Inflasi"
names(data_kpr)[8] <- "CreditRate"
```

# 2. Estimasi Regresi

```{r}
# Estimasi regresi OLS
regresi1 = lm(LnKPR ~ LnPDB + Inflasi + CreditRate + LnJII + DFTV, data = data_kpr)
summary(regresi1)
```

# 3 Uji Asumsi Klasik

Uji asumsi klasik dalam mengguanakan R Studio biasa menggunakan library gvlma\

## 3.1 Uji Normalitas

-   Biasa dikenal uji Jarque-Beras (JB)

```{r}
# Uji Normalitas, linear, heteroskedastisitas
# install.packages("gvlma")
library(gvlma)
gvlma(regresi1)
```

p \< tingkat signifikansi : **Tidak terdapat masalah normalitas**

## 3.2 Uji Heteroskedastisitas

-   Ragam eror yang tidak konstan

-   Apakah sisaan mempunyai hubungan yang berpola dengan variabel independen

-   Uji Breusch Pagan

```{r}
# Uji Heteroskedastisitas
# install.packages("car", dependencies=TRUE)
library(car)
ncvTest(regresi1)
```

Pada model menunjukkan bahwa p \> tingkat signifikansi : **Tidak terdapat masalah heteroskedastisitas**

## 3.3 Uji Autokorelasi

-   Uji first order spatial correlation

-   mengukur hubungan linier antara residual di dalam model regresi

    $u_t = r_u +e_t$

```{r}
# Uji Autokorelasi
library(lmtest)
dwtest(regresi1)
```

DW = 2 : Tidak terdapat autokorelasi

DW \< 2 : Terdapat autokorelasi positif

DW \> 2 & DW \< 4 : Terdapat korelasi negatif

"Hasil menunjukkan bahwa pada model **terdapat masalah autokorelasi**"

## 3.4 Uji Multikolinearitas

```{r}
# Uji Multikolinearitas
library(car)
vif(regresi1)
```

## Estimasi Robust Standard Error

```{r}
# Mengatasi masalah heteroskedastisitas dan autokorelasi
library(sandwich)
coeftest(regresi1, vcov = vcovHAC)
```
